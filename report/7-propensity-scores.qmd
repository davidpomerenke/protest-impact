## Causal analysis via propensity score

Same assumptions as for regression (@sec-reg-math):

- __Unconfoundedness__, $W \perp\!\!\!\perp Y(0) | X$: The counterfactual outcome if there was no treatment is independent from the actual treatment. (It is not plausible that this assumption actually holds, but regression will just serve as a baseline model.)
- __Overlap__, $e(X) < 1$ for the propensity score $e(X) = P(W=1|X)$: The treatment assignment is not deterministic.

$$
\begin{aligned}
E(Y(0)|W=1) &= E(WY(0))/P(W=1) \\
&= E{E(W|X)E[Y(0)|X]}/P(W=1) \\
&= E{E(W|X)\frac{E(1-W|X)}{E(1-W|X)}E[Y(0)|X]}/P(W=1) \\
&= E{E(W|X)\frac{1}{E(1-W|X)}E[(1-W)Y(0)|X]}/P(W=1) && Due to
unconfoundedness \\
&= E{E(W|X)\frac{1}{E(1-W|X)}E[Y(0)|X]}/P(W=1) \\
\end{aligned}
$$


Matching: creates imbalance [@kingWhyPropensityScores2019]

Stratification: depends on choice of hyperparameter k [@dingFirstCourseCausal2023, ch. 11]

IPW: seems okay, esp. doubly robust

### Inverse propensity weighting

https://www.pywhy.org/dowhy/v0.10/dowhy.causal_estimators.html#module-dowhy.causal_estimators.propensity_score_weighting_estimator

### Doubly robust estimation

https://econml.azurewebsites.net/_autosummary/econml.dr.LinearDRLearner.html

### Propensity scores from press release texts

cite Wager, and causal NLP overview

Predicting propensity scores from text: cite causalNLP overviews
For example, @bundeskriminalamtbkaLagebildLetzteGeneration2023 hypothesize that "Die Fallzahlen unterliegen einem „wellenartigen“ Verlauf, welcher sich vornehmlich durch (das Ausbleiben von) Großveranstaltungen im gleichen Kontext erklären lässt."
